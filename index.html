<!DOCTYPE html>
<html lang="az">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C…ôdv…ôl</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="manifest" href="site.webmanifest">
    <meta name="theme-color" content="#111827">
    <style>
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1f2937;
        }

        ::-webkit-scrollbar-thumb {
            background: #4b5563;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }

        body {
            font-family: system-ui, -apple-system, sans-serif;
        }
    </style>
</head>

<body class="bg-gray-900 text-gray-200 antialiased font-sans">
    <header class="bg-gray-800 border-b-4 border-blue-500 text-white font-bold p-4 text-2xl text-center shadow-lg">
        758/ITS</header>

    <nav class="flex flex-wrap justify-center items-center gap-3 my-6 px-4">
        <button onclick="showSection('kurs2Section')"
            class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-5 rounded-full transition transform hover:scale-105 shadow-md">2-ci
            KURS</button>
        <button onclick="window.location.href='https://kenox7.github.io/herkes/'"
            class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-5 rounded-full transition transform hover:scale-105 shadow-md">Qayƒ±blar</button>
        <button onclick="showSection('kurs1Section')"
            class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-5 rounded-full transition transform hover:scale-105 shadow-md">1-ci
            kurs</button>
        <button onclick="showSection('pdfsSection')"
            class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-5 rounded-full transition transform hover:scale-105 shadow-md">PDF</button>
        <button onclick="showSection('flappySection')"
            class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-5 rounded-full transition transform hover:scale-105 shadow-md">Flappy
            Ramin</button>
        <button onclick="showSection('bagikSection')"
            class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-5 rounded-full transition transform hover:scale-105 shadow-md">Bagik
            Run</button>
    </nav>

    <main class="container mx-auto px-4">
        <!-- Loader -->
        <div id="loader" class="text-center py-10 hidden">
            <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400"></div>
            <p class="mt-2 text-gray-400">C…ôdv…ôl y√ºkl…ônir...</p>
        </div>

        <div id="kurs2Section" class="content hidden">
            <h1
                class="text-4xl font-extrabold mb-2 text-center text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500">
                2-ci KURS C∆èDV∆èLƒ∞</h1>

            <!-- Week Navigation Controls -->
            <div class="flex flex-col items-center justify-center gap-3 mb-6">
                <h3 id="weekType" class="text-2xl text-yellow-400 font-bold drop-shadow-md"></h3>
                <div class="flex items-center gap-4 bg-gray-800 p-2 rounded-full shadow-lg border border-gray-700">
                    <button onclick="changeWeek(-1)"
                        class="p-2 rounded-full hover:bg-gray-700 text-blue-400 transition hover:scale-110 active:scale-95">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                        </svg>
                    </button>
                    <span id="dateRange" class="text-gray-300 font-mono font-semibold min-w-[140px] text-center"></span>
                    <button onclick="changeWeek(1)"
                        class="p-2 rounded-full hover:bg-gray-700 text-blue-400 transition hover:scale-110 active:scale-95">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                        </svg>
                    </button>
                </div>
                <button onclick="resetToToday()"
                    class="text-xs text-gray-500 hover:text-blue-400 underline decoration-dotted">Bug√ºn…ô qayƒ±t</button>
            </div>

            <div id="schedule_kurs2" class="max-w-2xl mx-auto space-y-4 px-2"></div>

            <!-- Comments Section -->
            <div id="commentsSection" class="max-w-3xl mx-auto mt-12 pt-6 border-t border-gray-700">
                <h2 class="text-3xl font-bold mb-6 text-center text-blue-300">Qeydl…ôr</h2>
                <form id="comment-form" class="flex flex-col md:flex-row gap-4 mb-6">
                    <input type="text" id="name-input" placeholder="Adƒ±n..." required
                        class="flex-grow bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 transition" />
                    <input type="text" id="comment-input" placeholder="Fikrini yaz..." required
                        class="flex-grow bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 transition" />
                    <button type="submit"
                        class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg transition-colors">G√∂nd…ôr</button>
                </form>
                <div id="comments-list"></div>
            </div>
        </div>

        <div id="kurs1Section" class="content hidden">
            <h1
                class="text-4xl font-extrabold mb-6 text-center text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500">
                1-ci KURS C∆èDV∆èLƒ∞</h1>
            <div id="schedule_kurs1" class="max-w-2xl mx-auto"></div>
        </div>

        <div id="pdfsSection" class="content hidden">
            <!-- PDF Content (preserved) -->
            <div class="grid md:grid-cols-2 gap-6 max-w-5xl mx-auto">
                <div class="bg-gray-800 rounded-lg shadow-xl p-6 border border-gray-700">
                    <h3 class="text-xl font-bold mb-3 text-blue-300">English for Information Technology 1</h3>
                    <iframe id="pdf1" class="w-full h-96 rounded-md border-2 border-gray-600" loading="lazy"></iframe>
                    <div class="mt-4 flex gap-2">
                        <a id="pdf1-download" target="_blank"
                            class="w-full text-center bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-full transition-colors">Y√ºkl…ô</a>
                    </div>
                </div>
                <div class="bg-gray-800 rounded-lg shadow-xl p-6 border border-gray-700">
                    <h3 class="text-xl font-bold mb-3 text-blue-300">Murphy (qƒ±rmƒ±zƒ± kitab)</h3>
                    <iframe id="pdf2" class="w-full h-96 rounded-md border-2 border-gray-600" loading="lazy"></iframe>
                    <div class="mt-4 flex gap-2">
                        <a id="pdf2-download" target="_blank"
                            class="w-full text-center bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-full transition-colors">Y√ºkl…ô</a>
                    </div>
                </div>
            </div>
        </div>

        <div id="flappySection" class="content hidden">
            <h1
                class="text-4xl font-extrabold mb-6 text-center text-center text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500">
                Flappy Ramin</h1>
            <div id="flappyContainer"
                class="aspect-video max-w-4xl mx-auto bg-gray-800 rounded-lg shadow-xl overflow-hidden border-2 border-gray-700">
            </div>
        </div>

        <div id="bagikSection" class="content hidden">
            <h1
                class="text-4xl font-extrabold mb-6 text-center text-center text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500">
                Bagik Run</h1>
            <div id="bagikContainer"
                class="aspect-video max-w-4xl mx-auto bg-gray-800 rounded-lg shadow-xl overflow-hidden border-2 border-gray-700">
            </div>
        </div>

        <!-- Comments Section (Merged from kohne.html) -->
        <div id="comments_container"></div>
        </div>
    </main>

    <footer class="text-center p-8 mt-10 text-gray-400">
        <p>@by Kenan</p>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-database.js";
        import { SystemManager } from "./firestore_manager.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAtQ_laoPhn_31RgUFp5hkHPzAcYJSH9_8",
            authDomain: "davamiyyet-sistemi.firebaseapp.com",
            databaseURL: "https://yorumlar-8f969-default-rtdb.firebaseio.com/",
            projectId: "davamiyyet-sistemi",
            storageBucket: "davamiyyet-sistemi.appspot.com",
            messagingSenderId: "773549402059",
            appId: "1:773549402059:web:25286906aa1d998041f84e",
            measurementId: "G-M3Y8QZCM8C"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const rtdb = getDatabase(app); // Realtime Database instance
        const manager = new SystemManager(db);
        const currentGroupId = "758_ITS";
        let currentSchedule = null;
        let viewOffset = 0; // 0 = current week, -1 = prev, 1 = next

        // --- Comments Logic ---
        const commentsRef = ref(rtdb, "comments");
        let clientId = localStorage.getItem('clientId');
        if (!clientId) {
            clientId = 'client-' + Math.random().toString(36).substring(2, 11);
            localStorage.setItem('clientId', clientId);
        }

        const commentForm = document.getElementById("comment-form");
        if (commentForm) {
            commentForm.addEventListener("submit", (e) => {
                e.preventDefault();
                const nameInput = document.getElementById("name-input");
                const commentInput = document.getElementById("comment-input");

                if (nameInput.value.trim() !== "" && commentInput.value.trim() !== "") {
                    push(commentsRef, {
                        name: nameInput.value,
                        text: commentInput.value,
                        timestamp: Date.now(),
                        clientId: clientId
                    });
                    nameInput.value = "";
                    commentInput.value = "";
                }
            });
        }

        onValue(commentsRef, (snapshot) => {
            const commentsList = document.getElementById("comments-list");
            if (!commentsList) return;

            commentsList.innerHTML = "";
            const commentsArray = [];
            snapshot.forEach((childSnapshot) => {
                commentsArray.push(childSnapshot.val());
            });

            commentsArray.sort((a, b) => b.timestamp - a.timestamp).forEach((data) => {
                const commentDiv = document.createElement("div");
                commentDiv.className = "bg-gray-800 p-4 rounded-lg mb-3 border border-gray-700";
                const date = new Date(data.timestamp);
                const formattedDate = date.toLocaleString("az-AZ", { dateStyle: 'medium', timeStyle: 'short' });
                commentDiv.innerHTML = `
            <p class="text-gray-200"><strong class="text-blue-300">${data.name}:</strong> ${data.text}</p>
            <small class="text-gray-500">${formattedDate}</small>
            `;
                commentsList.appendChild(commentDiv);
            });
        });

        async function init() {
            const loader = document.getElementById('loader');
            if (loader) loader.classList.remove('hidden');
            try {
                const semester = await manager.getActiveSemester();
                if (semester) {
                    currentSchedule = await manager.getGroupSchedule(semester.id, currentGroupId);
                    renderScheduleKurs2();
                } else {
                    const el = document.getElementById('schedule_kurs2');
                    if (el) el.innerHTML = "<p class='text-center text-gray-400'>Aktiv Semestr Yoxdur.</p>";
                }
            } catch (e) {
                console.error(e);
            } finally {
                if (loader) loader.classList.add('hidden');
                const section = document.getElementById('kurs2Section');
                if (section) section.classList.remove('hidden');
            }
        }

        // --- Helpers ---
        const startDate = new Date("2026-02-16"); // Updated to actual start

        function startOfDayCopy(d) {
            const c = new Date(d);
            c.setHours(0, 0, 0, 0);
            return c;
        }

        function hefteniTap(date) {
            const ref = startOfDayCopy(startDate);
            const d = startOfDayCopy(date);
            const diffMs = d.getTime() - ref.getTime();
            // Calculate week number (1-based)
            const diffWeeks = Math.floor(diffMs / (1000 * 60 * 60 * 24 * 7)) + 1;
            const type = (diffWeeks % 2 === 0) ? "alt" : "ust"; // Determine ALT/UST based on parity (Odd=UST, Even=ALT)
            return { type, number: diffWeeks > 0 ? diffWeeks : 1 };
        }

        function tarihFormatla(date) {
            const gunler = ["Bazar", "1-ci G√ºn<br> Bazar ert…ôsi", "2-ci G√ºn<br> √á…ôr≈ü…ônb…ô ax≈üamƒ±", "3-c√º G√ºn<br> √á…ôr≈ü…ônb…ô", "4-c√º G√ºn<br> C√ºm…ô ax≈üamƒ±", "5-ci G√ºn<br> C√ºm…ô", "≈û…ônb…ô"];
            return `${gunler[date.getDay()]}, ${date.toLocaleDateString('az-AZ')}`;
        }

        // Standard Lesson Times (Start - End)
        const lessonSlots = [
            { start: "09:00", end: "10:20" },
            { start: "10:30", end: "11:50" },
            { start: "12:10", end: "13:30" },
            { start: "13:40", end: "15:00" },
            { start: "15:10", end: "16:30" }
        ];

        function isLessonActive(slotIndex) {
            // slotIndex is 1-based from lesson data
            if (slotIndex < 1 || slotIndex > 5) return false;

            const now = new Date();
            const slot = lessonSlots[slotIndex - 1];

            const [sH, sM] = slot.start.split(':');
            const [eH, eM] = slot.end.split(':');

            const startTime = new Date(); startTime.setHours(sH, sM, 0);
            const endTime = new Date(); endTime.setHours(eH, eM, 0);

            return now >= startTime && now <= endTime;
        }

        // --- Render Logic ---

        // Navigation Functions
        window.changeWeek = (delta) => {
            viewOffset += delta;
            renderScheduleKurs2();
        };

        window.resetToToday = () => {
            viewOffset = 0;
            renderScheduleKurs2();
        };

        // Copy Function
        window.copyDaySchedule = (dateStr, lessonsArr) => {
            if (!lessonsArr || lessonsArr.length === 0) return;
            // Clean up lessons for text
            const textLines = lessonsArr.map(l => {
                let clean = l;
                if (l.startsWith('{')) clean = l.substring(l.indexOf('}') + 1).trim();
                return `‚Ä¢ ${clean}`;
            }).join('\n');

            const header = `üìÖ *${dateStr}* d…ôrsl…ôri:\n`;
            const footer = `\n____________________\n758/ITS C…ôdv…ôl`;

            const fullText = header + textLines + footer;

            navigator.clipboard.writeText(fullText).then(() => {
                alert("C…ôdv…ôl kopyalandƒ±! WhatsApp-da payla≈üa bil…ôrsiniz.");
            }).catch(err => {
                console.error("Copy failed", err);
            });
        };

        function renderScheduleKurs2() {
            let container = document.getElementById("schedule_kurs2");
            if (!container) return;

            container.innerHTML = "";

            // Calculate base date (Today + offset * 7)
            const today = new Date();
            const viewDate = new Date();
            viewDate.setDate(today.getDate() + (viewOffset * 7));

            // Find start of this view's week (Monday) (?)
            // Actually, keep the logic "Next 7 days starting from Today" or "Monday-Sunday"?
            // User asked for "Previous/Next Weeks". Usually means Monday-Sunday blocks.
            // Let's align to Monday for cleaner navigation.

            const dayOfWeek = viewDate.getDay(); // 0 (Sun) - 6 (Sat)
            const diffToMon = (dayOfWeek + 6) % 7; // How many days to subtract to get Monday
            const mondayDate = new Date(viewDate);
            mondayDate.setDate(viewDate.getDate() - diffToMon);

            // Determine Week Type based on Monday
            const weekInfo = hefteniTap(mondayDate);
            const weekType = weekInfo.type;

            // Update Headers
            const wtEl = document.getElementById("weekType");
            if (wtEl) wtEl.innerHTML = `
                <div class="flex flex-col items-center">
                    <span class="text-3xl font-bold ${weekType === 'alt' ? 'text-yellow-400' : 'text-green-400'} uppercase drop-shadow-sm">${weekType === 'alt' ? 'üü° ALT H∆èFT∆è' : 'üü¢ √úST H∆èFT∆è'}</span>
                    <span class="text-sm text-gray-400 font-mono tracking-widest mt-1">SEMESTRƒ∞N ${weekInfo.number}-Cƒ∞ H∆èFT∆èSƒ∞</span>
                </div>
            `;

            // Date Range String (Custom Format)
            const sunDate = new Date(mondayDate);
            sunDate.setDate(mondayDate.getDate() + 6);

            const azMonths = ["Yan", "Fev", "Mar", "Apr", "May", "ƒ∞yun", "ƒ∞yul", "Avq", "Sen", "Okt", "Noy", "Dek"];
            // Format: 16 Fev - 22 Fev
            const startStr = `${mondayDate.getDate()} ${azMonths[mondayDate.getMonth()]}`;
            const endStr = `${sunDate.getDate()} ${azMonths[sunDate.getMonth()]}`;

            document.getElementById("dateRange").innerText = `${startStr} - ${endStr}`;

            // Render 7 days starting from Monday
            for (let i = 0; i < 7; i++) {
                const date = new Date(mondayDate);
                date.setDate(mondayDate.getDate() + i);
                const loopDayIndex = date.getDay(); // 0-6

                // Only render Mon(1) to Fri(5)? Or show weekends too if desired?
                // Let's show Mon-Fri mainly, maybe Sat/Sun if needed. Original code did 1-5.
                // Keeping 1-5 for lessons.

                if (loopDayIndex >= 1 && loopDayIndex <= 5) {
                    const loopWeekInfo = hefteniTap(date);
                    const loopWeekType = loopWeekInfo.type;
                    const lessons = currentSchedule && currentSchedule[loopWeekType] ? currentSchedule[loopWeekType][loopDayIndex] : [];

                    // Check if this specific date is TODAY
                    const isTodayReal = (date.toDateString() === today.toDateString());

                    // Lesson Formatting
                    const lessonHtml = (lessons && lessons.length > 0)
                        ? lessons.sort().map((l) => {
                            let display = l;
                            let slotNum = null;

                            if (l.startsWith('{')) {
                                const endIdx = l.indexOf('}');
                                slotNum = parseInt(l.substring(1, endIdx));
                                display = l.substring(endIdx + 1).trim();
                            }

                            const hasLegacyNumbering = /^\d+\)/.test(display);
                            let numberPrefix = "";
                            if (!hasLegacyNumbering && slotNum) {
                                const mappedNum = (slotNum > 3) ? (slotNum - 3) : slotNum;
                                numberPrefix = `<span class="text-blue-400 font-bold mr-2 text-lg">${mappedNum}</span>`;
                            } else if (hasLegacyNumbering) {
                                const parts = display.match(/^(\d+\))(.*)/);
                                if (parts) {
                                    numberPrefix = `<span class="text-blue-400 font-bold mr-2 text-lg">${parts[1].replace(')', '')}</span>`;
                                    display = parts[2];
                                }
                            }

                            // 1. SMART BADGES
                            let typeBadge = "";
                            if (display.toLowerCase().includes("m√ºhazir…ô")) {
                                typeBadge = `<span class="px-2 py-0.5 rounded text-[10px] font-bold bg-purple-900/50 text-purple-300 border border-purple-700/50 uppercase tracking-wider ml-2">M√ºhazir…ô</span>`;
                                display = display.replace(/\(m√ºhazir…ô\)/i, '').trim(); // Remove raw text
                            } else if (display.toLowerCase().includes("seminar")) {
                                typeBadge = `<span class="px-2 py-0.5 rounded text-[10px] font-bold bg-orange-900/50 text-orange-300 border border-orange-700/50 uppercase tracking-wider ml-2">Seminar</span>`;
                                display = display.replace(/\(seminar\)/i, '').trim();
                            }

                            // 2. TEACHER PARSING
                            let content = display;
                            // FIX: Clean splitting by " - " (space hyphen space) to support subjects like "Subject-2"
                            if (display.includes(' - ')) {
                                const parts = display.split(' - ');
                                const subj = parts[0].trim();
                                const teach = parts.slice(1).join(' - ').trim();
                                content = `<span class="text-gray-100 font-semibold text-base">${subj}</span>${typeBadge}<span class="block text-sm text-gray-400 mt-1 flex items-center gap-2"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> ${teach}</span>`;
                            } else {
                                content = `<span>${display}</span>${typeBadge}`;
                            }

                            // 3. ACTIVE GLOW (Time Check)
                            // We need to know which slot this is. 
                            // If slotNum is available use it (adjust >3 logic), else try to guess from legacy string
                            let checkSlot = null;
                            if (slotNum) checkSlot = (slotNum > 3) ? (slotNum - 3) : slotNum;
                            // legacy fallback: numberPrefix contains the number
                            else if (numberPrefix.includes('1')) checkSlot = 1;
                            else if (numberPrefix.includes('2')) checkSlot = 2;
                            else if (numberPrefix.includes('3')) checkSlot = 3;

                            const isActive = isTodayReal && checkSlot && isLessonActive(checkSlot);

                            return `<div class="relative p-3 rounded-xl mt-3 text-sm flex items-start transition-all duration-500 overflow-hidden ${isActive ? 'bg-gradient-to-r from-green-900/40 to-gray-800 border-l-4 border-green-500 shadow-[0_0_15px_rgba(34,197,94,0.3)]' : 'bg-gray-700/30 border-l-4 border-blue-500/30 hover:bg-gray-700/50'}">
                                        ${isActive ? '<div class="absolute top-0 right-0 px-2 py-0.5 bg-green-600 text-[9px] font-bold text-white uppercase rounded-bl-lg shadow animate-pulse">Hazƒ±rda</div>' : ''}
                                        <div class="mt-0.5">${numberPrefix}</div>
                                        <div class="w-full pl-2">${content}</div>
                                    </div>`;
                        }).join('')
                        : "<div class='mt-4 text-center py-6 bg-gray-800/50 rounded-xl border border-dashed border-gray-700'><p class='text-gray-500 italic text-sm'>Bu g√ºn d…ôrsl…ôr yoxdur, istirah…ôt vaxtƒ±dƒ±r! üéÆ</p></div>";

                    // Prepare data for copy
                    const dateStr = tarihFormatla(date).replace('<br>', '');
                    const lessonsData = JSON.stringify(lessons).replace(/"/g, '&quot;');

                    container.innerHTML += `
                        <div class='relative group overflow-hidden rounded-xl transition-all duration-300 ${isTodayReal ? 'bg-gradient-to-br from-gray-800 to-gray-800 border-2 border-blue-500 shadow-[0_0_20px_rgba(59,130,246,0.2)] transform scale-[1.02]' : 'bg-gray-800 border border-gray-700 hover:border-gray-600'}'>
                            
                            <!-- Header -->
                            <div class="p-4 ${isTodayReal ? 'bg-blue-900/20' : 'bg-gray-900/50'} flex justify-between items-center border-b border-gray-700/50">
                                <div>
                                    <h4 class="text-lg font-bold ${isTodayReal ? 'text-blue-400' : 'text-gray-200'}">
                                        ${tarihFormatla(date)}
                                    </h4>
                                    ${isTodayReal ? '<span class="text-[10px] uppercase font-bold tracking-wider text-blue-500 animate-pulse">Bug√ºn</span>' : ''}
                                </div>
                                <button onclick="copyDaySchedule('${dateStr}', ${lessonsData})" class="text-gray-500 hover:text-white bg-gray-700/50 hover:bg-blue-600 p-2 rounded-lg transition-colors" title="Kopyala">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                    </svg>
                                </button>
                            </div>

                            <!-- Body -->
                            <div class="p-4 pt-2 pb-5">
                                ${lessonHtml}
                            </div>
                        </div>
                    `;
                }
            }
        }

        // --- Kurs 1 Static (Legacy) ---
        const dersCedveliKurs1 = {
            "alt": { 1: ["1)IT …ôsaslarƒ± (seminar) - Kazƒ±mov Ramin", "2)Diferensial t…ônlikl…ôr (m√ºhazir…ô) - Eyyubov Ramazan", "3)Fizika (m√ºhazir…ô) - ∆èlizad…ô Leyla"], 2: ["1)X…ôtti c…ôbr (seminar) - S…ôm…ôdzad…ô F…ôrahim", "2)XDƒ∞AK-2 (seminar) - Abbasova Nurid…ô"], 3: ["2)XDƒ∞AK-2 (seminar) - Abbasova Nurid…ô", "3)IT …ôsaslarƒ±-2 (m√ºhazir…ô) - Kazƒ±mov Ramin"], 4: ["3)ƒ∞nstrumental proqramlar (seminar) - G√∂y√º≈ül√º R…ôvan…ô"], 5: ["2)Proqramla≈üdƒ±rma …ôsaslarƒ± (m√ºhazir…ô) - S…ônan Niyazi", "3)ƒ∞nstrumental proqramlar (m√ºhazir…ô) - G√∂y√º≈ül√º R…ôvan…ô"] },
            "ust": { 1: ["1)X…ôtti c…ôbr (m√ºhazir…ô) - S…ôm…ôdzad…ô F…ôrahim", "2)Diferensial t…ônlikl…ôr (m√ºhazir…ô) - Eyyubov Ramazan", "3)Fizika (m√ºhazir…ô) - ∆èlizad…ô Leyla"], 2: ["1)X…ôtti c…ôbr (seminar) - S…ôm…ôdzad…ô F…ôrahim", "2)XDƒ∞AK-2 (seminar) - Abbasova Nurid…ô", "3)Proqramla≈üdƒ±rma (seminar) - S…ônan Niyazi"], 3: ["2)XDƒ∞AK-2 (seminar) - Abbasova Nurid…ô", "3)ƒ∞T …ôsaslarƒ±-2 (m√ºhazir…ô) - Kazƒ±mov Ramin"], 4: ["2)Diferensial t…ônlikl…ôr (seminar) - Ramazan Eyyubov", "3)Fizika Seminar (seminar) - ∆èlizad…ô Leyla"], 5: ["2)Proqramla≈üdƒ±rma …ôsaslarƒ± (m√ºhazir…ô) - S…ônan Niyazi", "3)ƒ∞nstrumental proqramlar (m√ºhazir…ô) - G√∂y√º≈ül√º R…ôvan…ô"] }
        };

        window.dersleriGosterKurs1 = function () {
            let container = document.getElementById("schedule_kurs1");
            if (!container) return;
            container.innerHTML = "";
            const gunler = ["", "1-ci G√ºn", "2-ci G√ºn", "3-c√º G√ºn", "4-c√º G√ºn", "5-ci G√ºn"];

            const renderWeek = (weekType) => {
                container.innerHTML += `<h2 class="text-2xl font-semibold my-4 mt-6 text-center text-yellow-400">${weekType.toUpperCase()} H∆èFT∆è</h2>`;
                for (let day = 1; day <= 5; day++) {
                    const lessons = dersCedveliKurs1[weekType][day];
                    const content = lessons ? lessons.map(l => `<div class="bg-gray-700/50 p-2 rounded mt-2">${l}</div>`).join('') : "D…ôrs yoxdur";
                    container.innerHTML += `<div class="bg-gray-800 p-4 rounded-xl mb-4 border border-gray-700"><strong class="text-blue-300">${gunler[day]}</strong><div class="mt-2 text-gray-300">${content}</div></div>`;
                }
            };
            renderWeek("alt");
            renderWeek("ust");
        }

        // --- Tabs / Navigation ---
        window.showSection = function (id) {
            document.querySelectorAll('.content').forEach(c => c.classList.add('hidden'));
            const el = document.getElementById(id);
            if (el) el.classList.remove('hidden');

            if (id === 'pdfsSection' && document.getElementById("pdf1") && !document.getElementById("pdf1").src) {
                // Load PDFs on demand
                document.getElementById("pdf1").src = "https://drive.google.com/file/d/1nis8yYs2h62nUswOa8qfGGlmHwZUZ0R2/preview";
                document.getElementById("pdf1-download").href = "https://drive.google.com/uc?export=download&id=1nis8yYs2h62nUswOa8qfGGlmHwZUZ0R2";
                document.getElementById("pdf2").src = "https://drive.google.com/file/d/16RVdE5pbYHQap9Em_sIZN2v8T0IJpT_e/preview";
                document.getElementById("pdf2-download").href = "https://drive.google.com/uc?export=download&id=16RVdE5pbYHQap9Em_sIZN2v8T0IJpT_e";
            } else if (id === 'flappySection' && !document.getElementById("flappyIframe")) {
                const f = document.createElement("iframe"); f.id = "flappyIframe"; f.src = "https://kenox7.github.io/FlappyRaminn/"; f.className = "w-full h-full border-none";
                document.getElementById("flappyContainer").appendChild(f);
            } else if (id === 'bagikSection' && !document.getElementById("bagikIframe")) {
                const b = document.createElement("iframe"); b.id = "bagikIframe"; b.src = "https://kenox7.github.io/BagikRun/"; b.className = "w-full h-full border-none";
                document.getElementById("bagikContainer").appendChild(b);
            } else if (id === 'kurs1Section') {
                dersleriGosterKurs1();
            }
        };

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            init(); // Load dynamic schedule
        });
    </script>
</body>

</html>
